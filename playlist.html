<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Favorilerim | Credos Music</title>
    <script src="script.js"></script>
    
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/cdexecctru/fileupld/main/p0iuu8ex/credos_music_logo.png">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <style>
        :root { --green: #1DB954; --bg: #000; --card-bg: #121212; }
        body { background: var(--bg); color: #fff; font-family: 'Montserrat', sans-serif; margin: 0; padding-bottom: 160px; overflow-x: hidden; user-select: none; }
        
        /* Playlist Tasarımı */
        .pl-header { height: 35vh; background: linear-gradient(transparent, rgba(0,0,0,0.8)), #1db95460; display: flex; align-items: flex-end; padding: 30px 40px; gap: 30px; }
        .pl-img { width: 232px; height: 232px; box-shadow: 0 8px 40px rgba(0,0,0,0.5); border-radius: 4px; }
        .pl-info h1 { font-size: 72px; margin: 10px 0; font-weight: 800; letter-spacing: -3px; }
        .back-btn { position: absolute; top: 20px; left: 20px; color: #fff; text-decoration: none; font-weight: 700; z-index: 10; background: rgba(0,0,0,0.5); padding: 8px 15px; border-radius: 20px; }

        /* Yeşil Oynat Butonu Bölümü */
        .action-bar { padding: 25px 40px; display: flex; align-items: center; }
        .play-btn-big { width: 56px; height: 56px; background: var(--green); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; border: none; box-shadow: 0 8px 15px rgba(0,0,0,0.3); }
        .play-btn-big:hover { transform: scale(1.08); background: #1ed760; }
        .play-btn-big i { color: #000; font-size: 22px; margin-left: 4px; }

        /* Liste Alanı */
        .song-list { padding: 0 40px; margin-top: 20px; }
        .list-header { display: grid; grid-template-columns: 50px 1fr 1fr 50px; padding: 10px 15px; border-bottom: 1px solid rgba(255,255,255,0.1); color: #b3b3b3; font-size: 13px; text-transform: uppercase; }
        .song-item { display: grid; grid-template-columns: 50px 1fr 1fr 50px; align-items: center; padding: 12px 15px; border-radius: 4px; cursor: pointer; transition: 0.2s; }
        .song-item:hover { background: rgba(255,255,255,0.1); }
        .song-item img { width: 40px; height: 40px; border-radius: 4px; margin-right: 15px; }
        .remove-btn { color: #b3b3b3; background: none; border: none; cursor: pointer; font-size: 18px; opacity: 0; transition: 0.2s; }
        .song-item:hover .remove-btn { opacity: 1; }
        .remove-btn:hover { color: #ff4444; }

        /* Player Bar */
        .player { position: fixed; bottom: 0; left: 0; width: 100%; background: #000; border-top: 1px solid #282828; padding: 15px 25px; box-sizing: border-box; z-index: 2000; }
        .p-inner { display: flex; align-items: center; justify-content: space-between; }
        .track-info { display: flex; align-items: center; gap: 15px; width: 30%; }
        .track-info img { width: 55px; height: 55px; border-radius: 4px; }
        .controls { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 8px; }
        .btns { display: flex; align-items: center; gap: 25px; }
        .btns i { font-size: 20px; color: #b3b3b3; cursor: pointer; }
        .btns i:hover { color: #fff; }
        .play-main { font-size: 35px !important; color: #fff; }
        .progress-box { width: 100%; max-width: 500px; display: flex; align-items: center; gap: 10px; font-size: 11px; color: #b3b3b3; }
        .bar-bg { flex: 1; height: 4px; background: #4f4f4f; border-radius: 2px; cursor: pointer; }
        .bar-fill { height: 100%; background: var(--green); width: 0%; border-radius: 2px; }
        .vol-zone { width: 30%; display: flex; justify-content: flex-end; align-items: center; gap: 12px; }

        @media (max-width: 992px) { .pl-info h1 { font-size: 40px; } .pl-img { width: 150px; height: 150px; } }
        @media (max-width: 768px) { .track-info, .vol-zone, .list-header span:nth-child(3) { display: none; } .song-item { grid-template-columns: 40px 1fr 50px; } }
    </style>
</head>
<body>

    <a href="index.html" class="back-btn"><i class="fas fa-chevron-left"></i> Geri Dön</a>

    <div class="pl-header">
        <img id="plCover" src="https://raw.githubusercontent.com/cdexecctru/fileupld/main/p0iuu8ex/credos_music_logo.png" class="pl-img">
        <div class="pl-info">
            <span style="font-size: 14px; font-weight: 700;">ÇALMA LİSTESİ</span>
            <h1>Favorilerim</h1>
            <p id="stats" style="color: #fff; font-size: 14px; font-weight: 600;"></p>
        </div>
    </div>

    <div class="action-bar">
        <button class="play-btn-big" onclick="playPlaylist()">
            <i class="fas fa-play" id="bigPlayBtn"></i>
        </button>
    </div>

    <div class="song-list">
        <div class="list-header">
            <span>#</span>
            <span>Başlık</span>
            <span>Albüm</span>
            <span><i class="far fa-clock"></i></span>
        </div>
        <div id="listArea"></div>
    </div>

    <div class="player">
        <div class="p-inner">
            <div class="track-info">
                <img id="pImg" src="https://raw.githubusercontent.com/cdexecctru/fileupld/main/p0iuu8ex/credos_music_logo.png">
                <div>
                    <h4 id="pTitle" style="margin:0; font-size:14px;">Müzik Seçin</h4>
                    <p style="margin:3px 0 0; font-size:11px; color:#b3b3b3;">Favorilerim</p>
                </div>
            </div>
            <div class="controls">
                <div class="btns">
                    <i class="fas fa-shuffle" id="shuf" onclick="toggleShuffle()"></i>
                    <i class="fas fa-step-backward" onclick="prev()"></i>
                    <i class="fa-solid fa-circle-play play-main" id="playBtn" onclick="toggle()"></i>
                    <i class="fas fa-step-forward" onclick="next()"></i>
                    <i class="fas fa-repeat" id="rep" onclick="toggleRepeat()"></i>
                </div>
                <div class="progress-box">
                    <span id="curT">0:00</span>
                    <div class="bar-bg" onclick="seek(event)"><div class="bar-fill" id="fill"></div></div>
                    <span id="totT">0:00</span>
                </div>
            </div>
            <div class="vol-zone">
                <i class="fas fa-volume-up" style="color:#b3b3b3"></i>
                <input type="range" min="0" max="100" value="100" oninput="setVol(this.value)" style="width:100px;">
            </div>
        </div>
    </div>

    <audio id="audio"></audio>

    <script>
        const GAS_URL = "https://script.google.com/macros/s/AKfycbx5nwWNZ_e5KZlZ57mbnrDAn6Ckvxei34e_ShIM5QupPzk5gU2JkmS8dBEdl5dHY6E7ng/exec";
        let currentUser = null; let userSongs = []; let curIdx = 0; let isShuffle = false; let isRepeat = false;
        const audio = document.getElementById('audio');

        async function init() {
            const res = await fetch(GAS_URL);
            const config = await res.json();
            firebase.initializeApp(config);
            firebase.auth().onAuthStateChanged(user => {
                if (user) { currentUser = user; loadPlaylist(); } 
                else { location.href = "index.html"; }
            });
        }

        function loadPlaylist() {
            userSongs = JSON.parse(localStorage.getItem('playlist_' + currentUser.uid)) || [];
            const area = document.getElementById('listArea');
            document.getElementById('stats').innerText = `${currentUser.displayName || 'Kullanıcı'} • ${userSongs.length} şarkı`;
            
            if (userSongs.length > 0) document.getElementById('plCover').src = userSongs[0].i;

            area.innerHTML = userSongs.map((s, i) => `
                <div class="song-item" onclick="playS(${i})">
                    <span style="color:#b3b3b3">${i+1}</span>
                    <div style="display:flex; align-items:center;">
                        <img src="${s.i}">
                        <span>${s.t}</span>
                    </div>
                    <span style="color:#b3b3b3">Credos Premium</span>
                    <button class="remove-btn" onclick="removeS(event, ${i})"><i class="fas fa-trash"></i></button>
                </div>
            `).join('');
        }

        function playPlaylist() { if(userSongs.length > 0) playS(0); }

        function playS(i) {
            curIdx = i; const s = userSongs[curIdx];
            audio.src = s.f; audio.play();
            document.getElementById('pTitle').innerText = s.t;
            document.getElementById('pImg').src = s.i;
            document.getElementById('playBtn').className = "fa-solid fa-circle-pause play-main";
            document.getElementById('bigPlayBtn').className = "fas fa-pause";
        }

        function toggle() {
            if(!audio.src) return;
            if(audio.paused) { audio.play(); document.getElementById('playBtn').className = "fa-solid fa-circle-pause play-main"; document.getElementById('bigPlayBtn').className = "fas fa-pause"; }
            else { audio.pause(); document.getElementById('playBtn').className = "fa-solid fa-circle-play play-main"; document.getElementById('bigPlayBtn').className = "fas fa-play"; }
        }

        function next() { curIdx = isShuffle ? Math.floor(Math.random()*userSongs.length) : (curIdx + 1) % userSongs.length; playS(curIdx); }
        function prev() { curIdx = (curIdx - 1 + userSongs.length) % userSongs.length; playS(curIdx); }
        function removeS(e, i) { e.stopPropagation(); userSongs.splice(i, 1); localStorage.setItem('playlist_' + currentUser.uid, JSON.stringify(userSongs)); loadPlaylist(); }
        function setVol(v) { audio.volume = v / 100; }
        function seek(e) { audio.currentTime = (e.offsetX / e.currentTarget.clientWidth) * audio.duration; }
        function toggleShuffle() { isShuffle = !isShuffle; document.getElementById('shuf').style.color = isShuffle ? "#1db954" : "#b3b3b3"; }
        function toggleRepeat() { isRepeat = !isRepeat; document.getElementById('rep').style.color = isRepeat ? "#1db954" : "#b3b3b3"; }

        audio.ontimeupdate = () => {
            if(audio.duration) {
                document.getElementById('fill').style.width = (audio.currentTime / audio.duration) * 100 + "%";
                document.getElementById('curT').innerText = fmt(audio.currentTime);
                document.getElementById('totT').innerText = fmt(audio.duration);
            }
        };
        function fmt(s) { let m=Math.floor(s/60), r=Math.floor(s%60); return m+":"+(r<10?"0"+r:r); }
        audio.onended = () => isRepeat ? audio.play() : next();

        init();
    </script>
</body>
</html>